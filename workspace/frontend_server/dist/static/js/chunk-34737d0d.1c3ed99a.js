(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34737d0d"],{"0e4e":function(e,t,i){},1276:function(e,t,i){"use strict";var r=i("d784"),a=i("44e7"),n=i("825a"),l=i("1d80"),s=i("4840"),o=i("8aa5"),d=i("50c4"),c=i("14c3"),u=i("9263"),m=i("d039"),p=[].push,h=Math.min,f=4294967295,g=!m((function(){return!RegExp(f,"y")}));r("split",2,(function(e,t,i){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,i){var r=String(l(this)),n=void 0===i?f:i>>>0;if(0===n)return[];if(void 0===e)return[r];if(!a(e))return t.call(r,e,n);var s,o,d,c=[],m=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,g=new RegExp(e.source,m+"g");while(s=u.call(g,r)){if(o=g.lastIndex,o>h&&(c.push(r.slice(h,s.index)),s.length>1&&s.index<r.length&&p.apply(c,s.slice(1)),d=s[0].length,h=o,c.length>=n))break;g.lastIndex===s.index&&g.lastIndex++}return h===r.length?!d&&g.test("")||c.push(""):c.push(r.slice(h)),c.length>n?c.slice(0,n):c}:"0".split(void 0,0).length?function(e,i){return void 0===e&&0===i?[]:t.call(this,e,i)}:t,[function(t,i){var a=l(this),n=void 0==t?void 0:t[e];return void 0!==n?n.call(t,a,i):r.call(String(a),t,i)},function(e,a){var l=i(r,e,this,a,r!==t);if(l.done)return l.value;var u=n(e),m=String(this),p=s(u,RegExp),v=u.unicode,b=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(g?"y":"g"),y=new p(g?u:"^(?:"+u.source+")",b),F=void 0===a?f:a>>>0;if(0===F)return[];if(0===m.length)return null===c(y,m)?[m]:[];var x=0,w=0,k=[];while(w<m.length){y.lastIndex=g?w:0;var _,$=c(y,g?m:m.slice(w));if(null===$||(_=h(d(y.lastIndex+(g?0:w)),m.length))===x)w=o(m,w,v);else{if(k.push(m.slice(x,w)),k.length===F)return k;for(var z=1;z<=$.length-1;z++)if(k.push($[z]),k.length===F)return k;w=x=_}}return k.push(m.slice(x)),k}]}),!g)},"128f":function(e,t,i){},1999:function(e,t,i){"use strict";i("db1f")},"1f4c":function(e,t,i){"use strict";i("2b7e")},"2b7e":function(e,t,i){},"2c83":function(e,t,i){"use strict";i("0e4e")},"34c6":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"f",(function(){return n})),i.d(t,"g",(function(){return l})),i.d(t,"b",(function(){return s})),i.d(t,"d",(function(){return o})),i.d(t,"h",(function(){return d})),i.d(t,"e",(function(){return c})),i.d(t,"c",(function(){return u})),i.d(t,"i",(function(){return m}));var r=i("b775");function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/rule/add",method:"post",data:e})}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/rule/search",method:"post",data:e})}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/rule/select",method:"post",data:e})}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/rule/assign",method:"post",data:e})}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/rule/edit",method:"post",data:e})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/rule/enabled",method:"post",data:e})}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/rule/remove",method:"post",data:e})}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/rule/batchRemove",method:"post",data:e})}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/rule/update",method:"post",data:e})}},"482b":function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"c",(function(){return n})),i.d(t,"f",(function(){return l})),i.d(t,"g",(function(){return s})),i.d(t,"d",(function(){return o})),i.d(t,"e",(function(){return d})),i.d(t,"h",(function(){return c})),i.d(t,"b",(function(){return u}));var r=i("b775");function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/option/add",method:"post",data:e})}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/option/edit",method:"post",data:e})}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/option/search",method:"post",data:e})}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/option/list",method:"post",data:e})}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/option/details",method:"post",data:e})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/option/info",method:"post",data:e})}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/option/remove",method:"post",data:e})}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(r["a"])({url:"/option/batchRemove",method:"post",data:e})}},"4e82":function(e,t,i){"use strict";var r=i("23e7"),a=i("1c0b"),n=i("7b0b"),l=i("d039"),s=i("a640"),o=[],d=o.sort,c=l((function(){o.sort(void 0)})),u=l((function(){o.sort(null)})),m=s("sort"),p=c||!u||!m;r({target:"Array",proto:!0,forced:p},{sort:function(e){return void 0===e?d.call(n(this)):d.call(n(this),a(e))}})},"69ba":function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:e.titleModel,visible:e.dialogVisible,width:"760px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.initForm}},[i("div",{staticClass:"header"},[i("el-steps",{staticStyle:{"margin-top":"20px"},attrs:{active:e.active,"process-status":"finish ","finish-status":"success",simple:""}},[i("el-step",{attrs:{title:"选择时间类型"}}),i("el-step",{attrs:{title:"设置打卡时间"}})],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.active,expression:"!active"}],staticClass:"from-box-type"},[i("el-form",{ref:"typeForm",staticClass:"demo-typeForm",attrs:{model:e.typeForm,rules:e.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"时间类型：",prop:"timeType"}},[i("el-radio-group",{attrs:{disabled:!!e.optionId},model:{value:e.typeForm.timeType,callback:function(t){e.$set(e.typeForm,"timeType",t)},expression:"typeForm.timeType"}},[i("el-radio",{attrs:{label:1}},[e._v("按星期设置")]),i("el-radio",{attrs:{label:2}},[e._v("按日期设置")])],1)],1),i("el-form-item",{attrs:{label:"标题：",prop:"title",size:"medium"}},[i("el-input",{attrs:{placeholder:"请输入，如 一周五天班朝九晚五"},model:{value:e.typeForm.title,callback:function(t){e.$set(e.typeForm,"title","string"===typeof t?t.trim():t)},expression:"typeForm.title"}})],1),i("el-form-item",{attrs:{label:"描述：",prop:"description"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:12},placeholder:"请输入，如 每周周一到周五打卡时间均为09:00-17:00"},model:{value:e.typeForm.description,callback:function(t){e.$set(e.typeForm,"description","string"===typeof t?t.trim():t)},expression:"typeForm.description"}})],1)],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!!e.active,expression:"!!active"}],staticClass:"from-box-time"},[i("el-form",{ref:"timeForm",staticClass:"demo-typeForm",attrs:{model:e.timeForm,rules:e.rules,"label-width":"100px"}},[2===e.typeForm.timeType?i("el-form-item",{attrs:{label:"日期：",prop:"date"}},[i("el-date-picker",{staticStyle:{width:"435px"},attrs:{type:"dates","value-format":"yyyy-MM-dd",placeholder:"请选择一个或多个日期"},model:{value:e.timeForm.date,callback:function(t){e.$set(e.timeForm,"date",t)},expression:"timeForm.date"}})],1):e._e(),1===e.typeForm.timeType?i("el-form-item",{staticClass:"week",attrs:{label:"星期：",prop:"week"}},[i("el-checkbox-group",{model:{value:e.timeForm.week,callback:function(t){e.$set(e.timeForm,"week",t)},expression:"timeForm.week"}},[e._l(e.weekData,(function(t,r){return i("el-checkbox",{key:r,attrs:{label:r+1}},[e._v(e._s(t))])})),i("el-checkbox",{attrs:{label:0}},[e._v("星期天")])],2)],1):e._e(),i("el-form-item",{attrs:{label:"打卡类型：",prop:"type",size:"medium"}},[i("el-radio-group",{attrs:{disabled:!!e.optionId},on:{change:e.ruleTypeChangeHandle},model:{value:e.timeForm.type,callback:function(t){e.$set(e.timeForm,"type",t)},expression:"timeForm.type"}},[i("el-radio",{attrs:{label:1}},[e._v("固定时间上下班")]),i("el-radio",{attrs:{label:2,disabled:""}},[e._v("自由上下班")]),i("el-radio",{attrs:{label:3}},[e._v("不上班")])],1)],1),3!==e.timeForm.type?i("el-form-item",{attrs:{label:1===e.timeForm.type?"打卡时段：":"打卡时长：",prop:"section"}},[1===e.timeForm.type?i("div",e._l(e.timeForm.section,(function(t,r){return i("div",{key:r,staticClass:"time-choice"},[i("span",{staticStyle:{"margin-right":"12px"}},[e._v("上班")]),i("el-time-select",{staticStyle:{width:"174px"},attrs:{size:"small",align:"right",clearable:"",placeholder:"上班","picker-options":{start:"00:00",step:"00:30",end:"23:59"}},model:{value:t[0],callback:function(i){e.$set(t,0,i)},expression:"time[0]"}}),i("span",{staticStyle:{margin:"12px"}},[e._v("-")]),i("span",{staticStyle:{"margin-right":"12px"}},[e._v("下班")]),i("el-time-select",{staticStyle:{width:"174px"},attrs:{size:"small",align:"right",placeholder:"下班",clearable:"","picker-options":{start:"00:00",step:"00:30",end:"23:59",minTime:t[0]}},model:{value:t[1],callback:function(i){e.$set(t,1,i)},expression:"time[1]"}})],1)})),0):e._e(),2===e.timeForm.type?i("div",[i("el-select",{staticStyle:{width:"435px"},attrs:{size:"small",placeholder:"请选择 工作时长",clearable:""},model:{value:e.timeForm.timeLen,callback:function(t){e.$set(e.timeForm,"timeLen",t)},expression:"timeForm.timeLen"}},e._l(e.timeData,(function(e,t){return i("el-option",{key:t,attrs:{label:e,value:t+1}})})),1),i("div",{staticClass:"tips"},[e._v("当天只需上满多少小时，不考虑上下班打卡时间")])],1):e._e()]):e._e()],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!!e.active,expression:"!!active"}],staticClass:"letf",attrs:{size:"small"},on:{click:function(t){e.active=0}}},[e._v("上一步")]),i("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{size:"small",type:"primary",loading:e.suerLoading},on:{click:e.sureHandle}},[e._v(e._s(e.active?"完成":"下一步"))])],1)])},a=[],n=i("5530"),l=(i("d81d"),i("cb29"),i("a15b"),i("159b"),i("ac1f"),i("1276"),i("4e82"),i("d3b7"),i("a4d3"),i("e01a"),i("a434"),i("482b")),s=["星期一","星期二","星期三","星期四","星期五","星期六"],o=Array(12).fill(1).map((function(e,t){return t+1+"小时"})),d=function(e){var t=e.map((function(e){return e.join("-")}));return t},c=function(e){var t=[];e.forEach((function(e){var i=[];e.forEach((function(e){var t=e?e.split(":"):[0,0];i.push(60*t[0]+(0|t[1]))})),t.push(i)})),t=t.sort((function(e,t){return e[0]-t[0]}));for(var i=0;i<t.length;i++){var r=t[i];if(r[0]>=r[1])return{sign:!1,msg:"存在无意义时间段"};for(var a=r[1],n=i+1;n<t.length;n++){var l=t[n];if(a>=l[0])return{sign:!1,msg:"存在时间段交集"}}}return{sign:!0,msg:"验证通过"}},u={name:"EditRule",data:function(){var e=this,t=function(t,i,r){var a=i;if(1===e.timeForm.type)if(a.length){var n=a.every((function(e){return 2===e.length&&e.every((function(e){return e}))}));if(n){var l=c(a);l.sign?r():r(new Error(l.msg))}else r(new Error("请填写完全"))}else r(new Error("请填写完全"));else 2===e.timeForm.type?a?r():r(new Error("请选择时段")):r()};return{titleModel:"新建规则选项",dialogVisible:!1,suerLoading:!1,active:0,weekData:s,timeData:o,typeForm:{id:"",timeType:1,title:"",description:""},optionId:"",loading:!1,cb:null,timeForm:{week:[1,2,3,4,5],type:1,date:[],section:[["09:00","18:00"]],timeLen:8},rules:{title:[{required:!0,message:"请输入规则标题",trigger:"blur"},{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"blur"}],date:[{type:"array",required:!0,message:"请选择日期",trigger:"change"}],section:[{required:!0,validator:t,trigger:"change"}],timeLen:[{required:!0,message:"请选择时段",trigger:"change"}],week:[{type:"array",required:!0,message:"请至少选择一天",trigger:"change"}],timeType:[{required:!0,message:"选择类型",trigger:"change"}],type:[{required:!0,message:"选择类型",trigger:"change"}],description:[{min:0,max:100,message:"长度最大100个字符",trigger:"blur"}]}}},watch:{optionId:function(e){e&&this.getData()}},methods:{init:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.optionId=this.typeForm.id=e,e&&(this.loading=!0),this.titleModel=e?"编辑规则选项":"新建规则选项",this.dialogVisible=!0,this.cb=t},getData:function(){var e=this;Object(l["e"])({optionId:this.optionId}).then((function(t){var i=t.option;e.typeForm={id:i.id,description:i.description,title:i.title,timeType:i.type}})).catch((function(){})).finally((function(){e.loading=!1}))},initForm:function(){var e=this;this.typeForm={id:"",timeType:1,title:"",description:""},this.active=0,this.optionId=null,this.timeForm={week:[1,2,3,4,5],type:1,date:null,section:[["09:00","18:00"]],timeLen:8},this.$nextTick((function(){e.$refs.typeForm.clearValidate(),e.$refs.timeForm.clearValidate()}))},sureHandle:function(){var e=this;0!==this.active?1===this.active&&this.$refs.timeForm.validate((function(t){if(t){e.suerLoading=!0;var i=Object(n["a"])(Object(n["a"])({},e.typeForm),e.timeForm);1===i.type&&(i.section=d(i.section));var r=e.optionId?l["c"]:l["a"];r(Object(n["a"])({},i)).then((function(t){e.$message.closeAll(),e.$message({message:"添加成功",type:"success"}),e.initForm(),"function"===typeof e.$parent.init&&e.$parent.init(),"function"===typeof e.cb&&e.cb(t.optionid),e.dialogVisible=!1})).catch((function(){})).finally((function(){e.suerLoading=!1}))}})):this.$refs.typeForm.validate((function(t){t&&(e.active=1)}))},ruleTypeChangeHandle:function(e){this.$refs.timeForm.validateField("section")},addTimeIvHandle:function(){this.timeForm.section.push(["09:00","18:00"]),this.$refs.timeForm.validateField("section")},delTimeIvHandle:function(e){this.timeForm.section.splice(e,1),this.$refs.timeForm.validateField("section")}}},m=u,p=(i("1999"),i("aa86"),i("2877")),h=Object(p["a"])(m,r,a,!1,null,"35ccae6a",null);t["a"]=h.exports},"81d5":function(e,t,i){"use strict";var r=i("7b0b"),a=i("23cb"),n=i("50c4");e.exports=function(e){var t=r(this),i=n(t.length),l=arguments.length,s=a(l>1?arguments[1]:void 0,i),o=l>2?arguments[2]:void 0,d=void 0===o?i:a(o,i);while(d>s)t[s++]=e;return t}},a15b:function(e,t,i){"use strict";var r=i("23e7"),a=i("44ad"),n=i("fc6a"),l=i("a640"),s=[].join,o=a!=Object,d=l("join",",");r({target:"Array",proto:!0,forced:o||!d},{join:function(e){return s.call(n(this),void 0===e?",":e)}})},aa86:function(e,t,i){"use strict";i("128f")},cb29:function(e,t,i){var r=i("23e7"),a=i("81d5"),n=i("44d2");r({target:"Array",proto:!0},{fill:a}),n("fill")},db1f:function(e,t,i){},f59c:function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"dashboard-container"},[i("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"140px"}},[i("el-form-item",{attrs:{label:"规则名称：",size:"medium",prop:"name"}},[i("el-input",{attrs:{placeholder:"建议“部门名称+打卡”，如：研发部门打卡"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),i("el-form-item",{attrs:{label:"描述：",size:"medium",prop:"description"}},[i("el-input",{attrs:{size:"medium",type:"textarea",autosize:{minRows:4,maxRows:12},placeholder:"请输入规则描述"},model:{value:e.ruleForm.description,callback:function(t){e.$set(e.ruleForm,"description",t)},expression:"ruleForm.description"}})],1),i("el-form-item",{attrs:{label:"打卡地点：",size:"medium",prop:"address"}},[i("el-button",{attrs:{size:"small"},on:{click:e.showAddressTableHandle}},[e._v("添加")]),i("span",{staticClass:"span-tips"},[e._v("可添加多个")]),e.ruleForm.address.length?i("div",{staticStyle:{"margin-top":"12px"}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.address,"cell-style":{"padding-top":"6px","padding-bottom":"6px"},"header-cell-style":{background:"#FAFAFA",height:"36px","line-height":"36px","padding-top":0,"padding-bottom":0},border:""}},[i("el-table-column",{attrs:{prop:"title",label:"地址名称"}}),i("el-table-column",{attrs:{prop:"region",label:"所在区域"}}),i("el-table-column",{attrs:{prop:"address",label:"详细地址"}})],1)],1):e._e()],1),i("el-form-item",{attrs:{label:"规则选项设置：",prop:"rules"}},[i("div",{staticClass:"mt-box"},[i("div",{staticClass:"tips"},[e._v("可添加多个，按显示顺序进行排序")]),i("el-select",{staticStyle:{width:"360px"},attrs:{multiple:"",size:"medium",placeholder:"请选择,可多选",clearable:""},model:{value:e.ruleForm.rules,callback:function(t){e.$set(e.ruleForm,"rules",t)},expression:"ruleForm.rules"}},e._l(e.option,(function(e,t){return i("el-option",{key:t,attrs:{label:e.title,value:e.id}})})),1),i("el-link",{staticClass:"line-button",staticStyle:{"margin-left":"20px"},attrs:{underline:!1},on:{click:e.showAddruleHandle}},[e._v("新建规则选项")])],1)]),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("保存")]),i("el-button",{attrs:{size:"small"},on:{click:function(t){return e.$router.back()}}},[e._v("返回")])],1)],1),i("Option",{ref:"option"}),i("AddressTable",{ref:"addressTable"})],1)},a=[],n=(i("a434"),i("d81d"),i("b0c0"),i("a4d3"),i("e01a"),i("d3b7"),i("3ca3"),i("ddb0"),i("34c6")),l=i("482b"),s=i("69ba"),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:"添加打卡地点",visible:e.dialogVisible,width:"760px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"header"},[i("el-input",{staticStyle:{width:"333px"},attrs:{placeholder:"搜索地址名称，如，长沙CSDN","prefix-icon":"el-icon-search",size:"small",clearable:""},model:{value:e.addressNameTemp,callback:function(t){e.addressNameTemp="string"===typeof t?t.trim():t},expression:"addressNameTemp"}}),i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.searchData}},[e._v("查 询")])],1),i("div",{staticClass:"address-box"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"cell-style":{"padding-top":"6px","padding-bottom":"6px"}},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),i("el-table-column",{attrs:{prop:"title",label:"地址名称","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"region",label:"所在区域","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{prop:"address",label:"详细地址","show-overflow-tooltip":""}})],1)],1),i("div",{staticClass:"table-pagination"},[i("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,30,50],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.num},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.sureHandle}},[e._v("确 定")])],1)])},d=[],c=i("b775");function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(c["a"])({url:"/address/search",method:"post",data:e})}var m={name:"AddressTable",data:function(){return{dialogVisible:!1,addressName:"",addressNameTemp:"",tableData:[],size:10,num:10,currentPage:1,multipleSelection:[]}},created:function(){this.init()},methods:{sureHandle:function(){var e=this.multipleSelection;if(!e.length)return this.$message.closeAll(),void this.$message.error("至少选择一个打卡地点");this.$parent.addAddressData(e),this.dialogVisible=!1},searchData:function(){this.addressName=this.addressNameTemp,this.init(1)},init:function(e){var t=this,i=e||this.currentPage;this.currentPage=i,u({title:this.addressName,start:i,size:this.size}).then((function(e){t.num=e.count,t.tableData=e.list}))},handleSizeChange:function(e){this.size=e,this.init()},handleCurrentChange:function(e){this.currentPage=e,this.init()},handleSelectionChange:function(e){this.multipleSelection=e}}},p=m,h=(i("2c83"),i("2877")),f=Object(h["a"])(p,o,d,!1,null,"9e2b9058",null),g=f.exports,v={name:"Rule",components:{AddressTable:g,Option:s["a"]},props:{ruleId:{type:String,default:""}},data:function(){return{address:[],option:[],loading:!1,ruleForm:{id:"",name:"",description:"",address:[],rules:[]},rules:{name:[{required:!0,message:"请输入规则名称",trigger:"blur"},{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"blur"}],description:[{min:0,max:100,message:"长度最大100个字符",trigger:"blur"}],rules:[{type:"array",required:!0,message:"请选择打卡规则",trigger:"change"}],address:[{type:"array",required:!0,message:"请选择打卡地点",trigger:"change"}]}}},created:function(){var e=this.ruleId?this.editInit:this.addInit;e()},methods:{showAddruleHandle:function(){var e=this;this.$refs.option.init(null,(function(t){e.addInit(),e.ruleForm.rules.push(t)}))},addRulesHandle:function(){this.ruleForm.rules.push(null)},delRulesHandle:function(e){this.ruleForm.rules.splice(e,1)},showAddressTableHandle:function(){this.$refs.addressTable.dialogVisible=!0},addAddressData:function(e){this.address=e,this.ruleForm.address=e.map((function(e){return e.id})),this.$refs.ruleForm.validateField("address")},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var i={ruleId:t.ruleId,title:"",description:"",addressId:"",optionId:""},r=t.ruleForm;i.title=r.name,i.description=r.description,i.addressId=r.address,i.optionId=r.rules;var a=t.ruleId?n["i"]:n["a"];a(i).then((function(){t.$message.closeAll(),t.$message({message:t.ruleId?"修改成功":"添加成功",type:"success"}),t.$router.push({name:"ruleClockList"})}))}))},resetForm:function(e){this.$refs[e].resetFields()},editInit:function(){var e=this;this.loading=!0,Promise.all([Object(l["g"])({size:1e6,start:1}),Object(n["d"])({ruleId:this.ruleId})]).then((function(t){e.loading=!1;var i=t[0],r=t[1],a=r.ruleData;e.option=i.list,e.address=r.addrList,e.ruleForm={id:a.id,name:a.title,address:r.addrList.map((function(e){return e.id})),description:a.description,rules:e.ruleForm.rules.length?e.ruleForm.rules:r.optionList}})).catch((function(){})).finally((function(){e.loading=!1}))},addInit:function(){var e=this;this.loading=!0,Object(l["g"])({size:1e6,start:1}).then((function(t){e.option=t.list})).catch((function(){})).finally((function(){e.loading=!1}))}}},b=v,y=(i("1f4c"),Object(h["a"])(b,r,a,!1,null,"376628bb",null));t["a"]=y.exports}}]);