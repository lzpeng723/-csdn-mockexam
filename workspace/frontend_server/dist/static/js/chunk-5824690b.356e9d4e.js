(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5824690b"],{"01ea":function(e,t,a){"use strict";a.d(t,"d",(function(){return u})),a.d(t,"g",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return o})),a.d(t,"f",(function(){return s})),a.d(t,"a",(function(){return n}));var i=["TINYINT","INT","BIGINT","DATE","DATETIME","CHAR","VARCHAR","TEXT"],r=["DATE","DATETIME","TEXT","LONGTEXT"],l=[{type:"text",label:"单行文本(text)",role:["CHAR","VARCHAR","TEXT"]},{type:"radio",label:"单选(radio)",role:["CHAR","VARCHAR","TEXT"]},{type:"checkbox",label:"多选(checkbox)",role:["CHAR","VARCHAR","TEXT"]},{type:"select",label:"下拉框(select))",role:["CHAR","VARCHAR","TEXT"]},{type:"date",label:"日期(date)",role:["DATE","DATETIME"]},{type:"datetime",label:"日期和时间(datetime)",role:["DATETIME"]},{type:"textarea",label:"多行文本(textarea)",role:["VARCHAR","TEXT"]},{type:"number",label:"数字(number)",role:["INT","BIGINT"]},{type:"password",label:"密码(password)",role:["CHAR","VARCHAR","TEXT"]},{type:"selectmultiple",label:"多选下拉框(select_multiple)",role:["CHAR","VARCHAR","TEXT"]}],o={text:"单行文本",radio:"单选",checkbox:"多选",select:"下拉框",date:"日期",datetime:"日期和时间",textarea:"多行文本",number:"数字",password:"密码",selectmultiple:"多选下拉框"},n=["DATE","DATETIME"],s=["radio","checkbox","date","datetime"],u=["radio","checkbox","select","selectmultiple"]},4604:function(e,t,a){},7019:function(e,t,a){},"8ef9":function(e,t,a){"use strict";a("4604")},"90fe":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"wrap"},[a("header",[a("div",{staticClass:"input_box"},[a("el-input",{staticStyle:{width:"224px"},attrs:{size:"medium",clearable:"",placeholder:"表单名称"},model:{value:e.modeNameTemp,callback:function(t){e.modeNameTemp="string"===typeof t?t.trim():t},expression:"modeNameTemp"}}),a("el-select",{staticStyle:{width:"224px"},attrs:{clearable:"",size:"medium",placeholder:"选择状态"},model:{value:e.statusTemp,callback:function(t){e.statusTemp=t},expression:"statusTemp"}},[a("el-option",{attrs:{label:"启用",value:1}}),a("el-option",{attrs:{label:"禁用",value:2}})],1)],1),a("div",{staticClass:"btn_box"},[a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.searchData}},[e._v(" 搜索 ")]),a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit",size:"small"},on:{click:e.modeAdd}},[e._v(" 添加 ")])],1)]),a("div",{staticClass:"main"},[a("div",{staticClass:"main-body"},[a("div",{staticClass:"mian-body-table"},[a("el-table",{ref:"ruleClockList",staticStyle:{width:"100%"},attrs:{data:e.tableData,"cell-style":{"padding-top":"12px","padding-bottom":"12px"},"default-sort":{prop:"create_time",order:"descending"}}},[a("el-table-column",{attrs:{prop:"table_guid",label:"ID",width:"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"table_alias",label:"表单名称","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"table_name",label:"表名","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"状态","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{style:{color:1==t.row.status?"#0486FE":"#FE4A49"}},[e._v(e._s(1==t.row.status?"已启用":"已禁用"))])]}}])}),a("el-table-column",{attrs:{label:"创建时间","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.created_time?e.parseTime(t.row.created_time):"-")+" ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"530",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"table-buttom"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.row.status,expression:"scope.row.status == 1"},{name:"clipboard",rawName:"v-clipboard:copy",value:"http://localhost:9528/#/form/"+t.row.table_guid,expression:"'http://localhost:9528/#/form/'+scope.row.table_guid",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"}],attrs:{size:"mini",plain:""}},[e._v("转发")]),a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){return e.$router.push({name:"Data",params:{id:t.row.table_guid},query:{name:t.row.table_alias,time:t.row.created_time}})}}},[e._v("已收信息")]),a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){return e.$router.push({name:"Field",params:{id:t.row.table_guid}})}}},[e._v("字段管理")]),a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){return e.previewHandle(t.row)}}},[e._v("预览")]),a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){return e.modeEdit(t.row)}}},[e._v("编辑")]),a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{size:"mini",type:1==t.row.status?"primary":"success"},on:{click:function(a){return e.changeStatus(t.row)}}},[e._v(e._s(1==t.row.status?"禁用":"启用"))]),a("el-popconfirm",{attrs:{"confirm-button-text":"确认","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"是否确认删除"},on:{confirm:function(a){return e.delModeHandle(t.row)}}},[a("el-button",{attrs:{slot:"reference",size:"mini",type:"danger"},slot:"reference"},[e._v("删除")])],1)],1)]}}])})],1),a("div",{staticClass:"table-pagination"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,30,50],"page-size":e.size,layout:"total, sizes, prev, pager, next, jumper",total:e.num},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])]),a("el-dialog",{attrs:{title:e.isModeAdd?"添加表单":"修改表单",visible:e.dialogVisible,width:"738px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"form-dis"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称",prop:"table_alias"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.table_alias,callback:function(t){e.$set(e.ruleForm,"table_alias",t)},expression:"ruleForm.table_alias"}})],1),a("el-form-item",{attrs:{label:"表名",prop:"table_name"}},[a("el-input",{attrs:{placeholder:"请输入，以字母开头，字母或数字或下划线构成",disabled:!e.isModeAdd},model:{value:e.ruleForm.table_name,callback:function(t){e.$set(e.ruleForm,"table_name",t)},expression:"ruleForm.table_name"}})],1),a("el-form-item",{attrs:{label:"描述",prop:"describe"}},[a("el-input",{attrs:{rows:3,placeholder:"请输入",type:"textarea"},model:{value:e.ruleForm.describe,callback:function(t){e.$set(e.ruleForm,"describe",t)},expression:"ruleForm.describe"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.btnLoding},on:{click:e.sureAdd}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:e.modeShowName,visible:e.dialogShowVisible,width:"800px"},on:{"update:visible":function(t){e.dialogShowVisible=t}}},[a("MyForm",{attrs:{"mode-guid":e.modeGuid+"***"+e.time},on:{fail:e.closePreview}})],1)],1)},r=[],l=a("5530"),o=(a("d3b7"),a("b775"));function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o["a"])({url:"/table/create",method:"post",data:e})}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o["a"])({url:"/table/update",method:"post",data:e})}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o["a"])({url:"/table/status",method:"post",data:e})}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o["a"])({url:"/table/del",method:"post",data:e})}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o["a"])({url:"/table/list",method:"post",data:e})}var m=a("ed08"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"wrap"},[a("div",{staticClass:"form"},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"auto"}},[e._l(e.fieldList,(function(t){return a("el-form-item",{key:t.guid,attrs:{label:t.field_name,prop:t.field}},["select"===t.input_type||"selectmultiple"===t.input_type?a("el-select",{attrs:{multiple:"selectmultiple"===t.input_type,clearable:"",placeholder:t.placeholder},model:{value:e.ruleForm[t.field],callback:function(a){e.$set(e.ruleForm,t.field,a)},expression:"ruleForm[item.field]"}},e._l(t.option.split("##"),(function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})),1):e._e(),"radio"===t.input_type?a("el-radio-group",{model:{value:e.ruleForm[t.field],callback:function(a){e.$set(e.ruleForm,t.field,a)},expression:"ruleForm[item.field]"}},e._l(t.option.split("##"),(function(i,r){return a("el-radio",{key:r,attrs:{label:i,name:e.ruleForm[t.field]}})})),1):e._e(),"checkbox"===t.input_type?a("el-checkbox-group",{model:{value:e.ruleForm[t.field],callback:function(a){e.$set(e.ruleForm,t.field,a)},expression:"ruleForm[item.field]"}},e._l(t.option.split("##"),(function(e,i){return a("el-checkbox",{key:i,attrs:{label:e,name:t.field}})})),1):e._e(),e.needOption.includes(t.input_type)?e._e():a("el-input",{attrs:{type:t.input_type||"text",placeholder:t.placeholder},model:{value:e.ruleForm[t.field],callback:function(a){e.$set(e.ruleForm,t.field,a)},expression:"ruleForm[item.field]"}})],1)})),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.showPush,expression:"showPush"}]},[a("el-button",{attrs:{type:"primary",loading:e.btnLoading},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("提交")]),a("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],2)],1)])},b=[],f=(a("ac1f"),a("1276"),a("25f0"),a("159b"),a("caad"),a("2532"),a("c7ea")),h=a("01ea"),g={props:{modeGuid:{type:String,default:"212222",required:!0},showPush:{type:Boolean,default:!1}},data:function(){return{needOption:h["d"],rules:{},loading:!1,btnLoading:!1,table_guid:"",ruleForm:{},fieldList:[]}},watch:{modeGuid:{immediate:!0,handler:function(e){var t=e;this.table_guid=(t||" *** ").split("***")[0],this.init()}}},methods:{submitForm:function(e){var t=this;this.btnLoading=!0,this.loading=!0,this.$refs[e].validate((function(a){if(!a)return t.btnLoading=!1,t.loading=!1,console.log("error submit!!"),!1;Object(f["d"])({table_guid:t.table_guid,form:Object(l["a"])({},t.changeObjString(t.ruleForm))}).then((function(a){t.$message({type:"success",message:"提交成功"}),t.resetForm(e)})).catch().finally((function(){t.btnLoading=!1,t.loading=!1}))}))},changeObjString:function(e){for(var t in e)if(Object.hasOwnProperty.call(e,t)){var a=e[t];"[object Array]"===Object.prototype.toString.call(a)&&(e[t]=e[t].toString())}return e},resetForm:function(e){this.$refs[e].resetFields()},init:function(){var e=this;this.loading=!0,Object(f["c"])({table_guid:this.table_guid}).then((function(t){var a=t.fields||[];if(!a.length)return e.$message.error("该模型没有表单字段，请录入字段后再尝试"),void e.$emit("fail");a.forEach((function(t){"checkbox"!==t.input_type&&"selectmultiple"!==t.input_type||e.$set(e.ruleForm,t.field,[]),e.rules[t.field]=[],1===t.required&&e.rules[t.field].push({required:!0,message:"字段为必填",trigger:"blur"}),t.field_length&&!h["d"].includes(t.input_type)&&e.rules[t.field].push({max:t.field_length,message:"长度最大为 ".concat(t.field_length,"个字符"),trigger:"blur"})})),e.$nextTick((function(){e.loading=!1,e.fieldList=a}))}))}}},v=g,_=a("2877"),w=Object(_["a"])(v,p,b,!1,null,"09ed9c50",null),y=w.exports,T={name:"TableList",components:{MyForm:y},data:function(){var e=function(e,t,a){var i=/^[a-zA-Z]{1}([a-zA-Z0-9]|[_]){0,}$/g;return t?i.test(t)?void a():a(new Error("以字母开头，字母或数字或下划线组成")):a(new Error("该字段不能为空"))};return{modeGuid:"",modeShowName:"",time:"",dialogShowVisible:!1,dialogVisible:!1,isModeAdd:!0,formatTime:m["a"],parseTime:m["b"],modeName:"",btnLoding:!1,modeNameTemp:"",status:"",statusTemp:"",size:10,tableData:[],loading:!1,num:10,currentPage:1,rules:{table_alias:[{required:!0,message:"请输入表单名称",trigger:"blur"}],table_name:[{required:!0,validator:e,trigger:"blur"}],describe:[{min:2,max:255,message:"长度在 2 到  255个字符",trigger:"change"}]},ruleForm:{table_alias:"",table_name:""}}},created:function(){console.log(this.$ELEMENT),this.init()},methods:{onCopy:function(e){this.$message.success("内容已复制到剪切板！")},closePreview:function(){this.dialogShowVisible=!1},previewHandle:function(e){this.modeGuid=e.table_guid,this.modeShowName=e.table_alias,this.time=Date.now(),this.dialogShowVisible=!0},newForm:function(e){var t=this.$router.resolve({name:"Form",query:{id:e}});window.open(t.href,"_blank")},changeStatus:function(e){var t=this;this.loading=!0,u({table_guid:e.table_guid,status:1===e.status?2:1}).then((function(a){t.$message({message:"修改成功",type:"success"}),t.loading=!1,e.status=1===e.status?2:1})).catch((function(){t.loading=!1,e.status=1===e.status?2:1,t.$message.error("修改失败")}))},delModeHandle:function(e){var t=this;this.loading=!0,c({table_guid:e.table_guid}).then((function(e){t.$message({message:"删除成功",type:"success"}),t.loading=!1,t.init()})).catch((function(){t.loading=!1}))},modeEdit:function(e){var t=this;this.ruleForm={table_guid:e.table_guid,table_alias:e.table_alias,table_name:e.table_name,describe:e.describe},this.$nextTick((function(){t.$refs.ruleForm.clearValidate()})),this.isModeAdd=!1,this.dialogVisible=!0},modeAdd:function(){var e=this;this.ruleForm={table_alias:"",table_name:""},this.$nextTick((function(){e.$refs.ruleForm.clearValidate()})),this.isModeAdd=!0,this.dialogVisible=!0},searchData:function(){this.modeName=this.modeNameTemp,this.status=this.statusTemp||null,this.init(1)},init:function(e){var t=this;this.loading=!0;var a=e||this.currentPage;this.currentPage=a;var i={page:a,size:this.size};this.modeName&&(i["table_alias"]=this.modeName),this.status&&(i["status"]=this.status),d(i).then((function(e){t.tableData=e.list,t.num=e.count})).finally((function(){t.loading=!1}))},handleSizeChange:function(e){this.size=e,this.init(1)},handleCurrentChange:function(e){this.currentPage=e,this.init()},sureAdd:function(){var e=this;this.btnLoding=!0,this.$refs.ruleForm.validate((function(t){if(!t)return console.log("error submit!!"),e.btnLoding=!1,!1;var a=e.isModeAdd?Object(l["a"])({},e.ruleForm):{table_guid:e.ruleForm.table_guid,table_alias:e.ruleForm.table_alias,describe:e.ruleForm.describe},i=e.isModeAdd?n:s;i(Object(l["a"])({},a)).then((function(){e.dialogVisible=!1,e.$message({message:"操作成功",type:"success"}),e.init()})).finally((function(){e.btnLoding=!1}))}))}}},F=T,x=(a("eced"),a("8ef9"),Object(_["a"])(F,i,r,!1,null,"1e28b2b8",null));t["default"]=x.exports},b775:function(e,t,a){"use strict";a("d3b7");var i=a("bc3a"),r=a.n(i),l=a("5c96"),o=r.a.create({baseURL:"http://localhost:8080",timeout:5e3});o.interceptors.response.use((function(e){var t=e.data;return 200!==t.code?(l["Message"].closeAll(),Object(l["Message"])({message:t.data||"Error",type:"error",duration:5e3}),Promise.reject(new Error(t.data||"Error"))):t.data}),(function(e){return console.log("err"+e),Object(l["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)})),t["a"]=o},c7ea:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return n}));var i=a("b775");function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/form/get",method:"post",data:e})}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/form/push",method:"post",data:e})}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/form/header",method:"post",data:e})}function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i["a"])({url:"/form/table",method:"post",data:e})}},eced:function(e,t,a){"use strict";a("7019")},ed08:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return l}));var i=a("53ca");a("ac1f"),a("5319"),a("4d63"),a("25f0"),a("d3b7"),a("4d90"),a("1276"),a("159b");function r(e,t){if(0===arguments.length||!e)return null;var a,r="{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(i["a"])(e)?a=e:("string"===typeof e&&(e=/^[0-9]+$/.test(e)?parseInt(e):e.replace(new RegExp(/-/gm),"/")),"number"===typeof e&&10===e.toString().length&&(e*=1e3),a=new Date(e));var l={y:a.getFullYear(),m:a.getMonth()+1,d:a.getDate(),h:a.getHours(),i:a.getMinutes(),s:a.getSeconds(),a:a.getDay()},o=r.replace(/{([ymdhisa])+}/g,(function(e,t){var a=l[t];return"a"===t?["日","一","二","三","四","五","六"][a]:a.toString().padStart(2,"0")}));return o}function l(e,t){e=10===(""+e).length?1e3*parseInt(e):+e;var a=new Date(e),i=Date.now(),l=(i-a)/1e3;return l<30?"刚刚":l<3600?Math.ceil(l/60)+"分钟前":l<86400?Math.ceil(l/3600)+"小时前":l<172800?"1天前":t?r(e):a.getMonth()+1+"月"+a.getDate()+"日"+a.getHours()+"时"+a.getMinutes()+"分"}}}]);